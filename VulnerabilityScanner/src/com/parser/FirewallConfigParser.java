package com.parser;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.util.ArrayList;

import com.global.Globals;
import com.google.gson.Gson;
import com.google.gson.stream.JsonReader;
import com.model.Firewall;

public class FirewallConfigParser {

	public ArrayList<Firewall> parseFiles() {

		Gson gson = new Gson();

		ArrayList<Firewall> firewalls = new ArrayList<Firewall>();
		File folder = new File(Globals.firewallConfigFolder);
		File[] listOfFiles = folder.listFiles();

		for (int i = 0; i < listOfFiles.length; i++) {

			try {
				JsonReader reader = new JsonReader(new FileReader(listOfFiles[i].getAbsolutePath().toString()));
				Firewall firewall = gson.fromJson(reader, Firewall.class);
				firewalls.add(firewall);

				// System.out.println("Firewall Name: " + firewall.getName());
				// System.out.println("Rules: ");
				// for (int j = 0; j < firewall.getRules().length; j++) {
				// System.out.println("Rule " + (j + 1));
				// System.out.println("Rule name: " +
				// firewall.getRules()[j].getName());
				// System.out.println("Rule port: " +
				// firewall.getRules()[j].getPort());
				// System.out.println("Rule protocol: " +
				// firewall.getRules()[j].getProtocol());
				// }
			} catch (FileNotFoundException e) {

				e.printStackTrace();
			}

		}

		return firewalls;

	}
}
